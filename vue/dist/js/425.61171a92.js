"use strict";(self["webpackChunkspringboot_vue_demo"]=self["webpackChunkspringboot_vue_demo"]||[]).push([[425],{11425:function(e,l,a){a.r(l),a.d(l,{default:function(){return O}});a(57658);var t=a(66252),i=a(2262),o=a(3577),s=a(65781),r=a(84471),d=a(81348),n=a(7869),m=a(93162),p=a(52300),h=a(6154);const g={style:{padding:"10px"}},u={style:{margin:"10px",padding:"0px"}},c={style:{margin:"10px",padding:"0px"}},w={style:{margin:"10px",padding:"0px"}},f={class:"btn-group"},y={class:"col"},b={class:"col"},_={style:{margin:"10px",padding:"0px"}},W={class:"radio-group-container"},k=(0,t._)("div",{class:"el-upload__tip"}," Any files with a size less than 10MB. ",-1),C={class:"dialog-footer"},U=(0,t._)("div",{class:"el-upload__tip"}," Any files with a size less than 10MB. ",-1),D={class:"dialog-footer"},V={class:"radio-group-container"},z={class:"dialog-footer"},P={class:"btn-group"},v={class:"col"},N={class:"col"},F={style:{margin:"10px",padding:"0px"}};let S=(0,i.iH)(),T=(0,i.iH)();const x={name:"Drawing",components:{},data(){return{previewUrl:"",form:{},historyForm:{},editForm:{drawingName:"",drawingType:""},previewForm:{},formInline:{},search:"",currentPage:1,pageSize:10,currentHisPage:1,pageHisSize:10,total:0,totalHis:0,dialogVisible:!1,updatedDialogVisible:!1,editDialogVisible:!1,historyDialogVisible:!1,fileData:"",EditData:"",oldFilePath:"",tableData:[],historyTableData:[],ids:[],selectedFiles:[]}},created(){this.load()},computed:{isDisabledUpload(){const{productNo:e,drawingName:l,drawingType:a}=this.form||{};return!e?.trim()||!l?.trim()||!a}},methods:{async handleDownLoadDrawings(){if(this.ids.length)for(const e of this.selectedFiles){const l=window.server.filesUploadUrl+":"+window.server.filesUploadPort+e.drawingPath.replace(window.server.filesUploadUrl,"");console.log(l);const a="http://"+l,t=document.createElement("a");t.href=a,t.target="_blank",t.download=a.split("/").pop(),t.click(),await new Promise((e=>setTimeout(e,1e3)))}else(0,d.z8)({message:"请选择数据",type:"warning"})},handleDeleteDrawings(){this.ids.length?r.Z.post("/drawing/deleteBatch",this.ids).then((e=>{console.log(e),"0"===e.code?((0,d.z8)({message:"批量删除成功",type:"success"}),this.del_files(this.ids).then((()=>{this.load()}))):(0,d.z8)({message:"批量删除失败",type:"error"})})):(0,d.z8)({message:"请选择数据",type:"warning"})},handleSelectionChange(e){this.ids=e.map((e=>e.id)),this.selectedFiles=e,console.log("this.selectedFiles:"+this.selectedFiles)},async historyLoad(){try{await this.delay(1e3),r.Z.post(`/drawing/historyList/${this.currentHisPage}/${this.pageHisSize}`,this.historyForm).then((e=>{console.log(e),this.historyTableData=e.data.records,this.totalHis=e.data.total}))}catch(e){console.error(e)}},showHistory(e){this.historyForm=JSON.parse(JSON.stringify(e)),this.historyLoad(),this.historyDialogVisible=!0},downloadFile(e){const l=window.server.filesUploadUrl+":"+window.server.filesUploadPort+e.drawingPath.replace(window.server.filesUploadUrl,"");console.log(l);const a="http://"+l,t=document.createElement("a");t.href=a,t.download=a.split("/").pop(),t.click()},updateVersion(e){this.form=JSON.parse(JSON.stringify(e)),this.oldFilePath=this.form.drawingPath,this.updatedDialogVisible=!0,this.$nextTick((()=>{this.$refs["updateDrawing"].clearFiles()}))},handleDialogHisClose(){this.historyTableData=[],this.historyDialogVisible=!1},handleCloseUpdateDialog(){this.cancelUpate()},handleCloseEditDialog(){this.cancel()},handleCloseDialog(){this.cancel()},updateFile(e){this.fileData=new FormData;let l=JSON.stringify(this.form);this.fileData.append("drawing",l),this.fileData.append("file",e.file),h.Z.request({method:"post",url:"http://"+window.server.filesUploadUrl+":9090/files/updateDrawingFiles",headers:{"Content-Type":"multipart/form-data",token:JSON.parse(sessionStorage.getItem("token"))},data:this.fileData}).then((e=>{let l=e.data;"0"===l.code&&((0,d.z8)({message:"更新成功",type:"success"}),this.form.drawingVersion=l.data.newVersion,this.form.drawingPath=l.data.filePath)})).catch((()=>{}))},handleBeforeUpdate(){T.value.submit()},uploadFile(e){this.fileData=new FormData;let l=JSON.stringify(this.form);this.fileData.append("drawing",l),this.fileData.append("file",e.file),h.Z.request({method:"post",url:"http://"+window.server.filesUploadUrl+":9090/files/uploadDrawingFiles",headers:{"Content-Type":"multipart/form-data",token:JSON.parse(sessionStorage.getItem("token"))},data:this.fileData}).then((e=>{let l=e.data;"0"===l.code&&((0,d.z8)({message:"上传成功",type:"success"}),this.form.drawingVersion="A01",this.form.drawingPath=l.data,this.oldFilePath=this.form.drawingPath)})).catch((()=>{}))},handleBeforeUpload(){S.value.submit()},exportExcel(){const e=this.tableData,l=n.utils.json_to_sheet(e),a=n.utils.book_new();n.utils.book_append_sheet(a,l,"Sheet1");const t="图纸数据.xlsx",i=new Blob([n.write(a,{bookType:"xlsx",type:"array"})],{type:"application/octet-stream"});m.saveAs(i,t)},getDrawingType(e){switch(e){case 1:return"材料清单";case 2:return"定屏图纸";case 3:return"配线图";case 4:return"技术交底单";default:return""}},filesUploadSuccess(e){this.form.drawingPath=e.data},delay(e){return new Promise((l=>setTimeout(l,e)))},async load(){try{await this.delay(1e3),r.Z.post(`/drawing/${this.currentPage}/${this.pageSize}`,JSON.parse(JSON.stringify(this.formInline))).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))}catch(e){console.error(e)}},reset(){this.formInline={},this.$refs["resetformInline"].resetFields()},add(){this.dialogVisible=!0,this.form={},this.$nextTick((()=>{this.$refs["upload"].clearFiles()}))},del_file(e){console.log("path"+e),r.Z.post("/files/delDrawingFile",{delDrawingPath:e}).then((e=>{console.log(e),"0"===e.code?(0,d.z8)({message:"nginx文件同步成功",type:"success"}):(0,d.z8)({message:"nginx文件同步失败",type:"error"})}))},del_files(e){return r.Z.post("/files/delDrawingFiles",this.ids).then((e=>{console.log(e),"0"===e.code?(0,d.z8)({message:"nginx文件同步成功",type:"success"}):(0,d.z8)({message:"nginx文件同步失败",type:"error"})}))},saveDrawing(){if(this.form.drawingType=parseInt(this.form.drawingType),this.form.id){const e={productNo:"产品编号",drawingType:"图纸类型",drawingName:"图纸名称",drawingPath:"图纸文件"},l=Object.keys(e);let a=!0,t=[];for(let i=0;i<l.length;i++){const o=l[i];this.form[o]||(a=!1,t.push(e[o]))}a?r.Z.post("/drawing",this.form).then((e=>{"0"===e.code?((0,d.z8)({message:"更新成功",type:"success"}),this.load()):(0,d.z8)({message:e.msg,type:"error"})})):(0,d.z8)({message:`缺少以下字段：${t.join(", ")}`,type:"warning"})}this.updatedDialogVisible=!1},save(){if(this.form.drawingType=parseInt(this.form.drawingType),this.form.id){console.log("test:"+this.form.drawingPath);const e={productNo:"产品编号",drawingType:"图纸类型",drawingName:"图纸名称",drawingPath:"图纸文件"},l=Object.keys(e);let a=!0,t=[];for(let i=0;i<l.length;i++){const o=l[i];this.form[o]||(a=!1,t.push(e[o]))}a?(console.log("test2:"+this.form.drawingPath),r.Z.post("/drawing/edit",{editDrawing:this.editForm,drawing:this.form}).then((e=>{"0"===e.code?((0,d.z8)({message:"修改成功",type:"success"}),this.load()):(0,d.z8)({message:e.msg,type:"error"})}))):(0,d.z8)({message:`缺少以下字段：${t.join(", ")}`,type:"warning"}),this.editDialogVisible=!1}else{const e={productNo:"产品编号",drawingType:"图纸类型",drawingName:"图纸名称",drawingPath:"图纸文件"},l=Object.keys(e);let a=!0,t=[];for(let i=0;i<l.length;i++){const o=l[i];this.form[o]||(a=!1,t.push(e[o]))}a?r.Z.post("/drawing",this.form).then((e=>{console.log("进入新增"),console.log("once time"+this.form.drawingPath),console.log("res:"+e),"0"===e.code?((0,d.z8)({message:"新增成功",type:"success"}),this.load()):(console.log("this.form"+this.form),(0,d.z8)({message:e.msg,type:"error"}),console.log("twice time"+this.form.drawingPath),console.log(this.oldFilePath),this.del_file(this.form.drawingPath))})):(0,d.z8)({message:`缺少以下字段：${t.join(", ")}`,type:"warning"}),this.dialogVisible=!1}},cancelUpate(){this.form.drawingPath!==this.oldFilePath&&(console.log("this.form.drawingPath:"+this.form.drawingPath),this.del_file(this.form.drawingPath)),this.dialogVisible=!1},cancelEdit(){this.editDialogVisible=!1,this.editForm.drawingName="",this.editForm.drawingType=""},cancel(){""!==this.oldFilePath&&(console.log("this.oldFilePath:"+this.oldFilePath),this.del_file(this.oldFilePath)),this.dialogVisible=!1},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),console.log("edit.row:",this.form),this.editForm.drawingType=this.form.drawingType,this.editForm.drawingName=this.form.drawingName,this.editDialogVisible=!0},previewFile(e){this.form=JSON.parse(JSON.stringify(e)),r.Z.get("/drawing/"+this.form.id).then((e=>{console.log(e),"0"===e.code?(this.previewUrl="http://"+e.data.drawingPath,console.log(this.previewUrl),window.open("http://127.0.0.1:8012/onlinePreview?url="+encodeURIComponent(p.DS.encode(this.previewUrl)))):(0,d.z8)({message:"预览失败",type:"error"})}))},handleSizeChange(){this.load()},handleCurrentChange(){this.load()},handleHisSizeChange(){this.historyLoad()},handleHisCurrentChange(){this.historyLoad()},handleDelete(e,l){console.log(e),r.Z["delete"]("/drawing/"+e).then((e=>{console.log(e),"0"===e.code?((0,d.z8)({message:"删除成功",type:"success"}),console.log("drawingPath"+l),this.del_file(l)):(0,d.z8)({message:"删除失败",type:"error"}),this.load()}))}}};var H=Object.assign(x,{setup(e){return(e,l)=>{const a=(0,t.up)("el-button"),r=(0,t.up)("el-input"),d=(0,t.up)("el-form-item"),n=(0,t.up)("el-option"),m=(0,t.up)("el-select"),p=(0,t.up)("el-form"),h=(0,t.up)("el-popconfirm"),x=(0,t.up)("el-table-column"),H=(0,t.up)("el-table"),I=(0,t.up)("el-pagination"),O=(0,t.up)("el-radio"),E=(0,t.up)("el-radio-group"),J=(0,t.up)("el-upload"),Z=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",g,[(0,t._)("div",u,[(0,t.Wm)(a,{color:"#E0BF75",onClick:e.add},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["onClick"]),(0,t.Wm)(a,{color:"#958CDD",onClick:e.exportExcel},{default:(0,t.w5)((()=>[(0,t.Uk)("导出")])),_:1},8,["onClick"]),(0,t.Wm)(a,{color:"#FC9DA9",onClick:e.load},{default:(0,t.w5)((()=>[(0,t.Uk)("刷新")])),_:1},8,["onClick"])]),(0,t._)("div",c,[(0,t.Wm)(p,{inline:!0,model:e.formInline,class:"demo-form-inline",ref:"resetformInline"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"料号"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.formInline.productNo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.formInline.productNo=l),placeholder:"please input",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸名称"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.formInline.drawingName,"onUpdate:modelValue":l[1]||(l[1]=l=>e.formInline.drawingName=l),placeholder:"Please input"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸类型"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:e.formInline.drawingType,"onUpdate:modelValue":l[2]||(l[2]=l=>e.formInline.drawingType=l),placeholder:"Please select"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{label:"材料清单",value:"1"}),(0,t.Wm)(n,{label:"定屏图纸",value:"2"}),(0,t.Wm)(n,{label:"配线图",value:"3"}),(0,t.Wm)(n,{label:"技术交底单",value:"4"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"存储路径"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.formInline.drawingPath,"onUpdate:modelValue":l[3]||(l[3]=l=>e.formInline.drawingPath=l),placeholder:"Please input"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,i.SU)(s.Search),onClick:e.load},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1},8,["icon","onClick"]),(0,t.Wm)(a,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,i.SU)(s.RefreshLeft),onClick:e.reset},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1},8,["icon","onClick"])])),_:1})])),_:1},8,["model"])]),(0,t._)("div",w,[(0,t.Wm)(a,{type:"primary",onClick:e.handleDownLoadDrawings},{default:(0,t.w5)((()=>[(0,t.Uk)("批量下载")])),_:1},8,["onClick"]),(0,t.Wm)(h,{title:"Are you sure to delete this?",onConfirm:e.handleDeleteDrawings},{reference:(0,t.w5)((()=>[(0,t.Wm)(a,{type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1})])),_:1},8,["onConfirm"])]),(0,t.Wm)(H,{data:e.tableData,style:{width:"100%"},border:"",class:"table",stripe:!1,onSelectionChange:e.handleSelectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{type:"selection",width:"55"}),(0,t.Wm)(x,{prop:"id",label:"ID",sortable:""}),(0,t.Wm)(x,{prop:"productNo",label:"产品料号"}),(0,t.Wm)(x,{prop:"itemNo",label:"项目编号"}),(0,t.Wm)(x,{prop:"drawingVersion",label:"文件版本"}),(0,t.Wm)(x,{prop:"drawingName",label:"图纸名称"}),(0,t.Wm)(x,{prop:"drawingType",label:"图纸类型"},{default:(0,t.w5)((l=>[(0,t.Uk)((0,o.zw)(e.getDrawingType(l.row.drawingType)),1)])),_:1}),(0,t.Wm)(x,{prop:"drawingPath",label:"存储路径"}),(0,t.Wm)(x,{prop:"createTime",label:"创建时间"}),(0,t.Wm)(x,{prop:"updateTime",label:"更新时间"}),(0,t.Wm)(x,{fixed:"right",label:"操作",width:"220"},{default:(0,t.w5)((l=>[(0,t._)("div",f,[(0,t._)("div",y,[(0,t.Wm)(a,{size:"small",onClick:a=>e.handleEdit(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑 ")])),_:2},1032,["onClick"]),(0,t.Wm)(a,{size:"small",onClick:a=>e.previewFile(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("预览 ")])),_:2},1032,["onClick"]),(0,t.Wm)(a,{size:"small",onClick:a=>e.downloadFile(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("下载文件")])),_:2},1032,["onClick"])]),(0,t._)("div",b,[(0,t.Wm)(a,{size:"small",onClick:a=>e.updateVersion(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("更新 ")])),_:2},1032,["onClick"]),(0,t.Wm)(h,{title:"Are you sure to delete this?",onConfirm:a=>e.handleDelete(l.row.id,l.row.drawingPath)},{reference:(0,t.w5)((()=>[(0,t.Wm)(a,{type:"danger",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"]),(0,t.Wm)(a,{size:"small",onClick:a=>e.showHistory(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("历史版本")])),_:2},1032,["onClick"])])])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,t._)("div",_,[(0,t.Wm)(I,{"current-page":e.currentPage,"onUpdate:currentPage":l[4]||(l[4]=l=>e.currentPage=l),"page-size":e.pageSize,"onUpdate:pageSize":l[5]||(l[5]=l=>e.pageSize=l),"page-sizes":[5,10,20,40],layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),(0,t.Wm)(Z,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[10]||(l[10]=l=>e.dialogVisible=l),title:"Tips",width:"50%","before-close":e.handleCloseDialog},{footer:(0,t.w5)((()=>[(0,t._)("span",C,[(0,t.Wm)(a,{onClick:e.cancel},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(a,{type:"primary",onClick:e.save},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(p,{model:e.form,"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"产品料号"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.productNo,"onUpdate:modelValue":l[6]||(l[6]=l=>e.form.productNo=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"项目编号"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.itemNo,"onUpdate:modelValue":l[7]||(l[7]=l=>e.form.itemNo=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸名称"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.drawingName,"onUpdate:modelValue":l[8]||(l[8]=l=>e.form.drawingName=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸类型"},{default:(0,t.w5)((()=>[(0,t._)("div",W,[(0,t.Wm)(E,{modelValue:e.form.drawingType,"onUpdate:modelValue":l[9]||(l[9]=l=>e.form.drawingType=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("材料清单")])),_:1}),(0,t.Wm)(O,{label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("定屏图纸")])),_:1}),(0,t.Wm)(O,{label:3},{default:(0,t.w5)((()=>[(0,t.Uk)("配线图")])),_:1}),(0,t.Wm)(O,{label:4},{default:(0,t.w5)((()=>[(0,t.Uk)("技术交底单")])),_:1})])),_:1},8,["modelValue"])])])),_:1}),(0,t.Wm)(d,{label:"选择文件"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{ref_key:"upload",ref:S,"auto-upload":!1,"http-request":e.uploadFile,disabled:e.isDisabledUpload},{trigger:(0,t.w5)((()=>[(0,t.Wm)(a,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("选择文件")])),_:1})])),tip:(0,t.w5)((()=>[k])),_:1},8,["http-request","disabled"])])),_:1}),(0,t.Wm)(d,{label:"上传文件"},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(a,{type:"primary",onClick:e.handleBeforeUpload},{default:(0,t.w5)((()=>[(0,t.Uk)("点击上传")])),_:1},8,["onClick"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(Z,{modelValue:e.updatedDialogVisible,"onUpdate:modelValue":l[11]||(l[11]=l=>e.updatedDialogVisible=l),title:"Tips",width:"50%","before-close":e.handleCloseUpdateDialog},{footer:(0,t.w5)((()=>[(0,t._)("span",D,[(0,t.Wm)(a,{onClick:e.cancelUpate},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(a,{type:"primary",onClick:e.saveDrawing},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(p,{model:e.form,"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"选择文件"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{ref_key:"updateDrawing",ref:T,"auto-upload":!1,"http-request":e.updateFile},{trigger:(0,t.w5)((()=>[(0,t.Wm)(a,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("选择文件")])),_:1})])),tip:(0,t.w5)((()=>[U])),_:1},8,["http-request"])])),_:1}),(0,t.Wm)(d,{label:"上传文件"},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(a,{type:"primary",onClick:e.handleBeforeUpdate},{default:(0,t.w5)((()=>[(0,t.Uk)("点击上传")])),_:1},8,["onClick"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(Z,{modelValue:e.editDialogVisible,"onUpdate:modelValue":l[16]||(l[16]=l=>e.editDialogVisible=l),title:"Tips",width:"50%","before-close":e.handleCloseEditDialog},{footer:(0,t.w5)((()=>[(0,t._)("span",z,[(0,t.Wm)(a,{onClick:e.cancelEdit},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(a,{type:"primary",onClick:e.save},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(p,{model:e.form,"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"产品料号"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.productNo,"onUpdate:modelValue":l[12]||(l[12]=l=>e.form.productNo=l),style:{width:"80%"},disabled:!0},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"项目编号"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.itemNo,"onUpdate:modelValue":l[13]||(l[13]=l=>e.form.itemNo=l),style:{width:"80%"},disabled:!0},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸名称"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:e.form.drawingName,"onUpdate:modelValue":l[14]||(l[14]=l=>e.form.drawingName=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"图纸类型"},{default:(0,t.w5)((()=>[(0,t._)("div",V,[(0,t.Wm)(E,{modelValue:e.form.drawingType,"onUpdate:modelValue":l[15]||(l[15]=l=>e.form.drawingType=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("材料清单")])),_:1}),(0,t.Wm)(O,{label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("定屏图纸")])),_:1}),(0,t.Wm)(O,{label:3},{default:(0,t.w5)((()=>[(0,t.Uk)("配线图")])),_:1}),(0,t.Wm)(O,{label:4},{default:(0,t.w5)((()=>[(0,t.Uk)("技术交底单")])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(Z,{modelValue:e.historyDialogVisible,"onUpdate:modelValue":l[19]||(l[19]=l=>e.historyDialogVisible=l),title:"Tips",width:"80%","close-on-click-modal":!1,"before-close":e.handleDialogHisClose},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{data:e.historyTableData,style:{width:"100%"},border:"",class:"table",stripe:!1},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{prop:"id",label:"ID",sortable:""}),(0,t.Wm)(x,{prop:"productNo",label:"产品料号"}),(0,t.Wm)(x,{prop:"itemNo",label:"项目编号"}),(0,t.Wm)(x,{prop:"drawingVersion",label:"文件版本"}),(0,t.Wm)(x,{prop:"drawingName",label:"图纸名称"}),(0,t.Wm)(x,{prop:"drawingType",label:"图纸类型"},{default:(0,t.w5)((l=>[(0,t.Uk)((0,o.zw)(e.getDrawingType(l.row.drawingType)),1)])),_:1}),(0,t.Wm)(x,{prop:"drawingPath",label:"存储路径"}),(0,t.Wm)(x,{prop:"createTime",label:"创建时间"}),(0,t.Wm)(x,{prop:"updateTime",label:"更新时间"}),(0,t.Wm)(x,{fixed:"right",label:"操作",width:"220"},{default:(0,t.w5)((l=>[(0,t._)("div",P,[(0,t._)("div",v,[(0,t.Wm)(a,{size:"small",onClick:a=>e.previewFile(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("预览 ")])),_:2},1032,["onClick"]),(0,t.Wm)(a,{size:"small",onClick:a=>e.downloadFile(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("下载文件")])),_:2},1032,["onClick"])]),(0,t._)("div",N,[(0,t.Wm)(h,{title:"Are you sure to delete this?",onConfirm:a=>e.handleDelete(l.row.id,l.row.drawingPath)},{reference:(0,t.w5)((()=>[(0,t.Wm)(a,{type:"danger",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])])])),_:1})])),_:1},8,["data"]),(0,t._)("div",F,[(0,t.Wm)(I,{"current-page":e.currentHisPage,"onUpdate:currentPage":l[17]||(l[17]=l=>e.currentHisPage=l),"page-size":e.pageHisSize,"onUpdate:pageSize":l[18]||(l[18]=l=>e.pageHisSize=l),"page-sizes":[5,10,20,40],layout:"total, sizes, prev, pager, next, jumper",total:e.totalHis,onSizeChange:e.handleHisSizeChange,onCurrentChange:e.handleHisCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])),_:1},8,["modelValue","before-close"])])}}});const I=H;var O=I}}]);
//# sourceMappingURL=425.61171a92.js.map