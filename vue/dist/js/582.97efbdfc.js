"use strict";(self["webpackChunkspringboot_vue_demo"]=self["webpackChunkspringboot_vue_demo"]||[]).push([[582],{1582:function(e,l,t){t.r(l),t.d(l,{default:function(){return b}});var a=t(6252),o=t(2262),s=t(5781),i=t(4471),r=t(1348);const n={style:{padding:"10px"}},d={style:{margin:"10px",padding:"0px"}},p={style:{margin:"10px",padding:"0px"}},u={class:"btn-group"},m={class:"col"},c={style:{margin:"10px",padding:"0px"}},h=(0,a._)("div",{class:"el-upload__tip"}," jpg/png files with a size less than 500KB. ",-1),g={class:"dialog-footer"},f={name:"User",components:{},data(){return{form:{departId:"",roleId:""},loading:!1,formInline:{},departList:[],roleList:[],search:"",currentPage:1,pageSize:10,total:0,dialogVisible:!1,importData:{imporType:1},headers:{token:JSON.parse(sessionStorage.getItem("token"))},tableData:[],filesUploadUrl:"http://"+window.server.filesUploadUrl+":9090/files/uploadUserIcons",departInputValue:"",roleInputValue:"",options:[]}},created(){console.log(this.headers),this.load(),this.getDepartList(),this.getRoleList()},methods:{handleDepartSelect(e){console.log("item.value"+e.value),this.form.departId=e.value},handleRoleSelect(e){console.log("item.value"+e.value),this.form.roleId=e.value},async queryDepartSearchAsync(e,l){try{console.log("this.departInputValue:"+this.departInputValue),i.Z.post("/depart/findListByName",JSON.stringify(this.departInputValue)).then((e=>{console.log(e),this.options=e.data.map((e=>({value:e.id,label:e.name}))),console.log("this.options:"+JSON.stringify(this.options)),l(this.options)}))}catch(t){console.error(t),l([])}},async queryRoleSearchAsync(e,l){try{console.log("this.roleInputValue:"+this.roleInputValue),i.Z.post("/role/findListByName",JSON.stringify(this.roleInputValue)).then((e=>{console.log(e),this.options=e.data.map((e=>({value:e.id,label:e.name}))),console.log("this.options:"+JSON.stringify(this.options)),l(this.options)}))}catch(t){console.error(t),l([])}},filesUploadSuccess(e){this.form.img=e.data},delay(e){return new Promise((l=>setTimeout(l,e)))},async getDepartList(){try{await this.delay(1e3),i.Z.post("/depart/1/10").then((e=>{console.log(e),this.departList=e.data.records}))}catch(e){console.error(e)}},async getRoleList(){try{await this.delay(1e3),i.Z.post("/role/1/10").then((e=>{console.log(e),this.roleList=e.data.records}))}catch(e){console.error(e)}},async load(){try{this.loading=!0,await this.delay(1e3),console.log("this.formInline:"+this.formInline),i.Z.post(`/user/${this.currentPage}/${this.pageSize}`,JSON.parse(JSON.stringify(this.formInline))).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))}catch(e){console.error(e)}finally{this.loading=!1}},reset(){this.formInline={},this.$refs["resetformInline"].resetFields()},add(){let e=this;e.dialogVisible=!0,e.form={},this.load(),this.$nextTick((()=>{this.$refs["upload"].clearFiles()}))},save(){this.form.id?i.Z.put("/user",this.form).then((e=>{console.log(e),"0"===e.code?(0,r.z8)({message:"修改成功",type:"success"}):(0,r.z8)({message:"修改失败",type:"error"})})):i.Z.post("/user",this.form).then((e=>{console.log(e),"0"===e.code?(0,r.z8)({message:e.msg,type:"success"}):(0,r.z8)({message:e.msg,type:"error"})})),this.dialogVisible=!1,this.load()},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.dialogVisible=!0,this.$nextTick((()=>{this.$refs["upload"].clearFiles()}))},handleSizeChange(){this.load()},handleCurrentChange(){this.load()},handleDelete(e){console.log(e),i.Z["delete"]("/user/"+e).then((e=>{console.log(e),"0"===e.code?(0,r.z8)({message:"删除成功",type:"success"}):(0,r.z8)({message:"删除失败",type:"error"}),this.load()}))},handleResetPassword(e){console.log(e),i.Z.get("/user/resetPassword/"+e).then((e=>{console.log(e),"0"===e.code?(0,r.z8)({message:"删除成功",type:"success"}):(0,r.z8)({message:"删除失败",type:"error"}),this.load()}))}}};var w=Object.assign(f,{setup(e){return(e,l)=>{const t=(0,a.up)("el-button"),i=(0,a.up)("el-input"),r=(0,a.up)("el-form-item"),f=(0,a.up)("el-form"),w=(0,a.up)("el-table-column"),y=(0,a.up)("el-image"),b=(0,a.up)("el-popconfirm"),W=(0,a.up)("el-table"),V=(0,a.up)("el-pagination"),_=(0,a.up)("el-autocomplete"),k=(0,a.up)("el-upload"),S=(0,a.up)("el-dialog"),U=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",d,[(0,a.Wm)(t,{color:"#3B455B",onClick:e.add},{default:(0,a.w5)((()=>[(0,a.Uk)("新增")])),_:1},8,["onClick"]),(0,a.Wm)(t,{color:"#3B455B"},{default:(0,a.w5)((()=>[(0,a.Uk)("导入")])),_:1}),(0,a.Wm)(t,{color:"#3B455B"},{default:(0,a.w5)((()=>[(0,a.Uk)("导出")])),_:1}),(0,a.Wm)(t,{color:"#3B455B"},{default:(0,a.w5)((()=>[(0,a.Uk)("刷新")])),_:1})]),(0,a._)("div",p,[(0,a.Wm)(f,{inline:!0,model:e.formInline,class:"demo-form-inline",ref:"resetformInline"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"用户名"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:e.formInline.username,"onUpdate:modelValue":l[0]||(l[0]=l=>e.formInline.username=l),placeholder:"please input",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"昵称"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:e.formInline.nickName,"onUpdate:modelValue":l[1]||(l[1]=l=>e.formInline.nickName=l),placeholder:"Please input"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(t,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,o.SU)(s.Search),onClick:e.load},{default:(0,a.w5)((()=>[(0,a.Uk)("查询")])),_:1},8,["icon","onClick"]),(0,a.Wm)(t,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,o.SU)(s.RefreshLeft),onClick:e.reset},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1},8,["icon","onClick"])])),_:1})])),_:1},8,["model"])]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(W,{data:e.tableData,style:{width:"100%"},border:"",class:"table",stripe:!1,fit:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{prop:"id",label:"ID",sortable:""}),(0,a.Wm)(w,{prop:"username",label:"用户名"}),(0,a.Wm)(w,{prop:"nickName",label:"昵称"}),(0,a.Wm)(w,{label:"用户角色",prop:"role.name"}),(0,a.Wm)(w,{label:"部门名称",prop:"depart.name"}),(0,a.Wm)(w,{prop:"permission",label:"权限"}),(0,a.Wm)(w,{label:"头像"},{default:(0,a.w5)((e=>[(0,a.Wm)(y,{style:{width:"100px",height:"100px"},src:e.row.img||"/static/default.png","preview-src-list":[e.row.img],"preview-teleported":"preview-teleported"},null,8,["src","preview-src-list"])])),_:1}),(0,a.Wm)(w,{fixed:"right",label:"操作",width:"190"},{default:(0,a.w5)((l=>[(0,a._)("div",u,[(0,a._)("div",m,[(0,a.Wm)(t,{size:"small",onClick:t=>e.handleEdit(l.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑 ")])),_:2},1032,["onClick"]),(0,a.Wm)(b,{title:"你确定要删除用户吗?",onConfirm:t=>e.handleDelete(l.row.id)},{reference:(0,a.w5)((()=>[(0,a.Wm)(t,{type:"danger",size:"small"},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"]),(0,a.Wm)(b,{title:"重置密码后，账号原密码将会失效，确定重置?",onConfirm:t=>e.handleResetPassword(l.row.id)},{reference:(0,a.w5)((()=>[(0,a.Wm)(t,{type:"warning",size:"small"},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1})])),_:2},1032,["onConfirm"])])])])),_:1})])),_:1},8,["data"])),[[U,e.loading]]),(0,a._)("div",c,[(0,a.Wm)(V,{"current-page":e.currentPage,"onUpdate:currentPage":l[2]||(l[2]=l=>e.currentPage=l),"page-size":e.pageSize,"onUpdate:pageSize":l[3]||(l[3]=l=>e.pageSize=l),"page-sizes":[5,10,20,40],layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),(0,a.Wm)(S,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[10]||(l[10]=l=>e.dialogVisible=l),title:"Tips",width:"30%"},{footer:(0,a.w5)((()=>[(0,a._)("span",g,[(0,a.Wm)(t,{onClick:l[9]||(l[9]=l=>e.dialogVisible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("Cancel")])),_:1}),(0,a.Wm)(t,{type:"primary",onClick:e.save},{default:(0,a.w5)((()=>[(0,a.Uk)(" Confirm ")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(f,{model:e.form,"label-width":"120px"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"用户名"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:e.form.username,"onUpdate:modelValue":l[4]||(l[4]=l=>e.form.username=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"昵称"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:e.form.nickName,"onUpdate:modelValue":l[5]||(l[5]=l=>e.form.nickName=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"角色类型",prop:"RoleId"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{modelValue:e.roleInputValue,"onUpdate:modelValue":l[6]||(l[6]=l=>e.roleInputValue=l),"fetch-suggestions":e.queryRoleSearchAsync,"popper-append-to-body":!0,placeholder:"请输入内容","trigger-on-focus":!0,"value-key":"label",onSelect:e.handleRoleSelect},null,8,["modelValue","fetch-suggestions","onSelect"])])),_:1}),(0,a.Wm)(r,{label:"权限"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:e.form.permission,"onUpdate:modelValue":l[7]||(l[7]=l=>e.form.permission=l),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"部门名称",prop:"departId"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{modelValue:e.departInputValue,"onUpdate:modelValue":l[8]||(l[8]=l=>e.departInputValue=l),"fetch-suggestions":e.queryDepartSearchAsync,"popper-append-to-body":!0,placeholder:"请输入内容","trigger-on-focus":!0,"value-key":"label",onSelect:e.handleDepartSelect},null,8,["modelValue","fetch-suggestions","onSelect"])])),_:1}),(0,a.Wm)(r,{label:"头像"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{ref:"upload",action:e.filesUploadUrl,headers:e.headers,data:e.importData,"on-success":e.filesUploadSuccess},{tip:(0,a.w5)((()=>[h])),default:(0,a.w5)((()=>[(0,a.Wm)(t,{type:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)("Click to upload")])),_:1})])),_:1},8,["action","headers","data","on-success"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});const y=w;var b=y}}]);
//# sourceMappingURL=582.97efbdfc.js.map