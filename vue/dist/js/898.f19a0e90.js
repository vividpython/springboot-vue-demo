"use strict";(self["webpackChunkspringboot_vue_demo"]=self["webpackChunkspringboot_vue_demo"]||[]).push([[898],{76898:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var s=a(66252),l=a(2262),o=a(65781),n=a(84471),i=a(81348);const r={style:{padding:"10px"}},p={style:{margin:"10px",padding:"0px"}},d={style:{margin:"10px",padding:"0px"}},u={style:{margin:"10px",padding:"0px"}},c={style:{margin:"10px",padding:"0px"}},h={name:"UserStatus",components:{},data(){return{form:{departId:"",roleId:""},loading:!1,formInline:{},departList:[],roleList:[],search:"",currentPage:1,pageSize:10,total:0,dialogVisible:!1,importData:{imporType:1},headers:{token:JSON.parse(sessionStorage.getItem("token"))},tableData:[],filesUploadUrl:"http://"+window.server.filesUploadUrl+":9090/files/uploadUserIcons",departInputValue:"",roleInputValue:"",options:[],ids:[],selectedFiles:[],status:-1}},created(){console.log(this.headers),this.load(),this.getDepartList(),this.getRoleList()},methods:{handleOpenUsersStatus(){this.status=0,this.handleUsersStatus()},handleBanUsersStatus(){this.status=1,this.handleUsersStatus()},handleUsersStatus(){this.ids.length?n.Z.post(`/user/handleUsersStatus/${this.status}`,this.ids).then((e=>{console.log(e),"0"===e.code?(0,i.z8)({message:e.msg,type:"success"}):"101"===e.code?(0,i.z8)({message:e.msg,type:"warning"}):(0,i.z8)({message:e.msg,type:"info"}),this.load()})):(0,i.z8)({message:"请选择数据",type:"warning"})},handleSelectionChange(e){this.ids=e.map((e=>e.id)),this.selectedFiles=e,console.log("this.selectedFiles:"+this.selectedFiles)},statusChange(e){console.log("row"+e.status),this.form=JSON.parse(JSON.stringify(e)),console.log("this.form.status"+this.form.status);try{n.Z.post("/user/updateUserstatus",this.form).then((e=>{console.log(e),"0"===e.code?1===this.form.status?(0,i.z8)({message:"用户已禁用",type:"warning"}):(0,i.z8)({message:"用户已启用",type:"success"}):(0,i.z8)({message:e.msg,type:"error"})}))}catch(t){console.error(t)}},beforeChangeStatus(e){return this.form=JSON.parse(JSON.stringify(e)),new Promise(((t,a)=>{try{0==e.status?e.status=1:e.status=0,t(!0)}catch(s){a(!1)}}))},handleDepartSelect(e){console.log("item.value"+e.value),this.form.departId=e.value},handleRoleSelect(e){console.log("item.value"+e.value),this.form.roleId=e.value},async queryDepartSearchAsync(e,t){try{console.log("this.departInputValue:"+this.departInputValue),n.Z.post("/depart/findListByName",JSON.stringify(this.departInputValue)).then((e=>{console.log(e),this.options=e.data.map((e=>({value:e.id,label:e.name}))),console.log("this.options:"+JSON.stringify(this.options)),t(this.options)}))}catch(a){console.error(a),t([])}},async queryRoleSearchAsync(e,t){try{console.log("this.roleInputValue:"+this.roleInputValue),n.Z.post("/role/findListByName",JSON.stringify(this.roleInputValue)).then((e=>{console.log(e),this.options=e.data.map((e=>({value:e.id,label:e.name}))),console.log("this.options:"+JSON.stringify(this.options)),t(this.options)}))}catch(a){console.error(a),t([])}},filesUploadSuccess(e){this.form.img=e.data,console.log("this.form.img:"+this.form.img)},delay(e){return new Promise((t=>setTimeout(t,e)))},async getDepartList(){try{await this.delay(1e3),n.Z.post("/depart/1/10").then((e=>{console.log(e),this.departList=e.data.records}))}catch(e){console.error(e)}},async getRoleList(){try{await this.delay(1e3),n.Z.post("/role/1/10").then((e=>{console.log(e),this.roleList=e.data.records}))}catch(e){console.error(e)}},async load(){try{this.loading=!0,await this.delay(1e3),console.log("this.formInline:"+this.formInline),n.Z.post(`/user/${this.currentPage}/${this.pageSize}`,JSON.parse(JSON.stringify(this.formInline))).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))}catch(e){console.error(e)}finally{this.loading=!1}},reset(){this.formInline={},this.$refs["resetformInline"].resetFields()},handleSizeChange(){this.load()},handleCurrentChange(){this.load()}}};var m=Object.assign(h,{setup(e){return(e,t)=>{const a=(0,s.up)("el-button"),n=(0,s.up)("el-input"),i=(0,s.up)("el-form-item"),h=(0,s.up)("el-option"),m=(0,s.up)("el-select"),g=(0,s.up)("el-form"),f=(0,s.up)("el-popconfirm"),y=(0,s.up)("el-table-column"),S=(0,s.up)("el-switch"),w=(0,s.up)("el-table"),b=(0,s.up)("el-pagination"),C=(0,s.Q2)("loading");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",p,[(0,s.Wm)(a,{color:"#3B455B"},{default:(0,s.w5)((()=>[(0,s.Uk)("刷新")])),_:1})]),(0,s._)("div",d,[(0,s.Wm)(g,{inline:!0,model:e.formInline,class:"demo-form-inline",ref:"resetformInline"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{label:"用户名"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:e.formInline.username,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formInline.username=t),placeholder:"please input",clearable:""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(i,{label:"昵称"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:e.formInline.nickName,"onUpdate:modelValue":t[1]||(t[1]=t=>e.formInline.nickName=t),placeholder:"Please input"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(i,{label:"状态"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{modelValue:e.formInline.status,"onUpdate:modelValue":t[2]||(t[2]=t=>e.formInline.status=t),placeholder:"Please select","collapse-tags":"","collapse-tags-tooltip":"",multiple:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{label:"启用",value:"0"}),(0,s.Wm)(h,{label:"禁用",value:"1"})])),_:1},8,["modelValue"])])),_:1}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(a,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,l.SU)(o.Search),onClick:e.load},{default:(0,s.w5)((()=>[(0,s.Uk)("查询")])),_:1},8,["icon","onClick"]),(0,s.Wm)(a,{color:"#E0BF75",style:{"margin-left":"5px"},icon:(0,l.SU)(o.RefreshLeft),onClick:e.reset},{default:(0,s.w5)((()=>[(0,s.Uk)("重置")])),_:1},8,["icon","onClick"])])),_:1})])),_:1},8,["model"])]),(0,s._)("div",u,[(0,s.Wm)(f,{title:"你确定要删除吗，删除之后数据将无法恢复?",onConfirm:e.handleBanUsersStatus},{reference:(0,s.w5)((()=>[(0,s.Wm)(a,{type:"danger"},{default:(0,s.w5)((()=>[(0,s.Uk)("批量禁用")])),_:1})])),_:1},8,["onConfirm"]),(0,s.Wm)(f,{title:"你确定要删除吗，删除之后数据将无法恢复?",onConfirm:e.handleOpenUsersStatus},{reference:(0,s.w5)((()=>[(0,s.Wm)(a,{type:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("批量启用")])),_:1})])),_:1},8,["onConfirm"])]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(w,{data:e.tableData,style:{width:"100%"},border:"",class:"table",stripe:!1,onSelectionChange:e.handleSelectionChange,fit:""},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{type:"selection",width:"55"}),(0,s.Wm)(y,{prop:"id",label:"ID",sortable:""}),(0,s.Wm)(y,{prop:"username",label:"用户名"}),(0,s.Wm)(y,{prop:"nickName",label:"昵称"}),(0,s.Wm)(y,{prop:"status",label:"是否启用",align:"center",sortable:"custom","show-overflow-tooltip":""},{default:(0,s.w5)((t=>[(0,s.Wm)(S,{"model-value":t.row.status,"active-value":0,"inactive-value":1,size:"large",class:"ml-2","inline-prompt":"","active-text":"启用","inactive-text":"禁用",onChange:a=>e.statusChange(t.row),"before-change":e.beforeChangeStatus.bind(this,t.row),style:{"--el-switch-on-color":"#409EFF","--el-switch-off-color":"#ff4949"}},null,8,["model-value","onChange","before-change"])])),_:1}),(0,s.Wm)(y,{label:"用户角色",prop:"role.name"}),(0,s.Wm)(y,{label:"部门名称",prop:"depart.name"})])),_:1},8,["data","onSelectionChange"])),[[C,e.loading]]),(0,s._)("div",c,[(0,s.Wm)(b,{"current-page":e.currentPage,"onUpdate:currentPage":t[3]||(t[3]=t=>e.currentPage=t),"page-size":e.pageSize,"onUpdate:pageSize":t[4]||(t[4]=t=>e.pageSize=t),"page-sizes":[5,10,20,40],layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])}}});const g=m;var f=g}}]);
//# sourceMappingURL=898.f19a0e90.js.map